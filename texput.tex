    \documentclass{scrartcl}
    \usepackage{tikz}
    \pagestyle{empty}

    \begin{document}
      % The logic for Hanoi, we record the discs at every pole
      % as a comma separated list ending with a '.'; i.e. the
      % starting list for 4 discs would be 1,2,3,4,.
      \newcount\ndiscs
      \def\initpoles#1{
          \def\disclist{}
          \foreach \n in {1,...,#1} {
              \xdef\disclist{\disclist\n,}
          }
          \expandafter\xdef\csname pole 1\endcsname{\disclist.}
          \expandafter\gdef\csname pole 2\endcsname{.}
          \expandafter\gdef\csname pole 3\endcsname{.}
      }

      % Delimited macro; #1 is everything up to the first ',' and
      % #2 everything after it.
      \def\head#1,#2.{#1}
      \def\tail#1,#2.{#2}

      % This macro updates the disc lists, its arguments are the name
      % names of the macro's corresponding to the poles, for example
      % 'pole 1' and 'pole 3'.
      \def\movedisc#1#2{
            \edef\lista{\csname #1\endcsname}
            \edef\listb{\csname #2\endcsname}
            \expandafter\xdef\csname #2\endcsname{\expandafter\head\lista,\listb}
            \expandafter\xdef\csname #1\endcsname{\expandafter\tail\lista.}
      }

      % Updates the lists and then draws a new frame.
      \def\move#1#2{
            \movedisc{pole #1}{pole #2}
      }

      % This macro boils down to a well-known recursive solution, as given
      % here for example: http://en.wikipedia.org/wiki/Towers_of_Hanoi#Recursive_solution
      %
      % #1 Pole to move from
      % #2 Pole to move to
      % #3 Pole to use as scratch
      % #4 Number of disks
      \def\rhanoi#1#2#3#4{
            \ifnum#4>1
                {\advance#4 by -1 \rhanoi#1#3#2#4}
                \move{#1}{#3}
                {\advance#4 by -1 \rhanoi#2#1#3#4}
            \else
                \move{#1}{#3}
            \fi
      }

      % Main macro, inits the lists for the current number, sets a title
      % for the frame and starts the recursion.
      \def\hanoi#1{
              \ndiscs=#1
              \initpoles{#1}
              % Recursion draws a new frame for every step.
              \rhanoi{1}{2}{3}{\ndiscs}
      }
      
      \hanoi{20}
    \end{document}
